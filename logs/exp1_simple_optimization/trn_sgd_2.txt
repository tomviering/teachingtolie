Starting at vr okt  4 14:59:53 CEST 2019
hyperparameter settings:
{'nb_classes': 2, 'train_batch_size': 32, 'val_batch_size': 3, 'epoch': 500, 'lr': 0.01, 'weight_decay': 0.0002, 'input_shape': (224, 224), 'test_domain': 10, 'print_freq': 1, 'gt_val_acc': 0.78, 'criterion': 1, 'loss': 2, 'dataset': 'imagenette', 'lambda': 0.01, 'vis_name': 'trn_sgd_2', 'optimizer': 'sgd', 'cuda': True}
loading the model
loading pretrained model for imagenette...
computing accuracy on validation data...
/home/nfs/tjviering/explain/lib/python3.6/site-packages/torchvision/transforms/transforms.py:209: UserWarning: The use of the transforms.Scale transform is deprecated, please use transforms.Resize instead.
  "please use transforms.Resize instead.")
/tudelft.net/staff-bulk/ewi/insy/VisionLab/tjviering/teachingtolienewpaper/utils.py:223: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  input = torch.tensor(preprocessed_img, dtype=torch.float32, requires_grad=True)
percentage 0 of 100
percentage 10 of 100
percentage 20 of 100
percentage 30 of 100
percentage 40 of 100
percentage 50 of 100
percentage 60 of 100
percentage 70 of 100
percentage 80 of 100
percentage 90 of 100
val acc: 1.00000
class loss 0.03091
gradcam loss 0.69864
got 5 images
showing image 0 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9708
class 009 [ostrich, Struthio ca] posterior 0.0109
class 003 [tiger shark, Galeoce] posterior 0.0057
class 008 [hen                 ] posterior 0.0032
class 005 [electric ray, crampf] posterior 0.0029
ground truth 0
close figures to continue...
showing image 1 of 5
class 000 [tench, Tinca tinca  ] posterior 0.8398
class 003 [tiger shark, Galeoce] posterior 0.1144
class 007 [cock                ] posterior 0.0202
class 005 [electric ray, crampf] posterior 0.0141
class 006 [stingray            ] posterior 0.0075
ground truth 0
close figures to continue...
showing image 2 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9516
class 003 [tiger shark, Galeoce] posterior 0.0405
class 008 [hen                 ] posterior 0.0032
class 007 [cock                ] posterior 0.0013
class 001 [goldfish, Carassius ] posterior 0.0011
ground truth 0
close figures to continue...
showing image 3 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9991
class 003 [tiger shark, Galeoce] posterior 0.0006
class 008 [hen                 ] posterior 0.0001
class 007 [cock                ] posterior 0.0001
class 009 [ostrich, Struthio ca] posterior 0.0000
ground truth 0
close figures to continue...
showing image 4 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9993
class 009 [ostrich, Struthio ca] posterior 0.0004
class 003 [tiger shark, Galeoce] posterior 0.0002
class 008 [hen                 ] posterior 0.0001
class 004 [hammerhead, hammerhe] posterior 0.0000
ground truth 0
close figures to continue...
/tudelft.net/staff-bulk/ewi/insy/VisionLab/tjviering/teachingtolienewpaper/utils.py:357: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  y_original_p = torch.nn.functional.softmax(y)
[epoch 1], [iter 1 / 16], [class loss 0.02053] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 2 / 16], [class loss 0.01986] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 3 / 16], [class loss 0.01626] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 4 / 16], [class loss 0.01418] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 5 / 16], [class loss 0.02089] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 6 / 16], [class loss 0.02321] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 7 / 16], [class loss 0.02373] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 8 / 16], [class loss 0.02530] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 9 / 16], [class loss 0.02913] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 10 / 16], [class loss 0.02774] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 11 / 16], [class loss 0.02933] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 12 / 16], [class loss 0.03612] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 13 / 16], [class loss 0.03488] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 14 / 16], [class loss 0.03646] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 15 / 16], [class loss 0.03778] [gradcam loss 0.00000 ][memory used 6053]
[epoch 1], [iter 16 / 16], [class loss 0.03697] [gradcam loss 0.00000 ][memory used 6053]
train acc: 0.99600
epoch took 6 seconds
epoch took approximately 0 minutes
got 5 images
showing image 0 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9874
class 009 [ostrich, Struthio ca] posterior 0.0099
class 008 [hen                 ] posterior 0.0008
class 005 [electric ray, crampf] posterior 0.0007
class 003 [tiger shark, Galeoce] posterior 0.0005
ground truth 0
close figures to continue...
showing image 1 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9857
class 003 [tiger shark, Galeoce] posterior 0.0109
class 005 [electric ray, crampf] posterior 0.0019
class 007 [cock                ] posterior 0.0009
class 006 [stingray            ] posterior 0.0004
ground truth 0
close figures to continue...
showing image 2 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9849
class 003 [tiger shark, Galeoce] posterior 0.0111
class 008 [hen                 ] posterior 0.0023
class 009 [ostrich, Struthio ca] posterior 0.0005
class 001 [goldfish, Carassius ] posterior 0.0004
ground truth 0
close figures to continue...
showing image 3 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9999
class 003 [tiger shark, Galeoce] posterior 0.0000
class 008 [hen                 ] posterior 0.0000
class 007 [cock                ] posterior 0.0000
class 009 [ostrich, Struthio ca] posterior 0.0000
ground truth 0
close figures to continue...
showing image 4 of 5
class 000 [tench, Tinca tinca  ] posterior 0.9999
class 009 [ostrich, Struthio ca] posterior 0.0001
class 003 [tiger shark, Galeoce] posterior 0.0000
class 008 [hen                 ] posterior 0.0000
class 007 [cock                ] posterior 0.0000
ground truth 0
close figures to continue...
computing accuracy on validation data...
/tudelft.net/staff-bulk/ewi/insy/VisionLab/tjviering/teachingtolienewpaper/utils.py:357: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  y_original_p = torch.nn.functional.softmax(y)
/tudelft.net/staff-bulk/ewi/insy/VisionLab/tjviering/teachingtolienewpaper/utils.py:223: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  input = torch.tensor(preprocessed_img, dtype=torch.float32, requires_grad=True)
percentage 0 of 100
percentage 10 of 100
percentage 20 of 100
percentage 30 of 100
percentage 40 of 100
percentage 50 of 100
percentage 60 of 100
percentage 70 of 100
percentage 80 of 100
percentage 90 of 100
val acc: 1.00000
class loss 0.00825
gradcam loss 0.69956
model trained until completion! saving...
Finished at vr okt  4 15:00:31 CEST 2019
